pipeline {
    agent any
    stages {
        stage("Create Pull Request") {
            steps {
                script {
                    def repo_owner = "<repo_owner>"
                    def repo_name = "<repo_name>"
                    def access_token = "<access_token>"
                    def title = "<pull_request_title>"
                    def head = "<head_branch>"
                    def base = "master"
                    def body = "<pull_request_body>"
                    
                    def url = "https://api.github.com/repos/${repo_owner}/${repo_name}/pulls"
                    def headers = [
                        "Authorization": "Token ${access_token}",
                        "Accept": "application/vnd.github+json"
                    ]
                    def payload = [
                        "title": title,
                        "head": head,
                        "base": base,
                        "body": body
                    ]
                    
                    def response = httpRequest(url: url, httpMode: 'POST', customHeaders: headers, requestBody: payload.toString())
                    if (response.status == 201) {
                        def pull_request = readJSON(text: response.content)
                        echo "Pull request created successfully: ${pull_request['html_url']}"
                    } else {
                        echo "Failed to create pull request. Response status: ${response.status}"
                    }
                }
            }
        }
    }
}
